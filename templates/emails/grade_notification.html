{% extends "emails/base_email.html" %}

{% block title %}Your Project Has Been Graded - {{ grade }}/20{% endblock %}

{% block header_title %}Project Graded{% endblock %}
{% block header_subtitle %}{{ classroom_title }}{% endblock %}

{% block content %}
<div class="greeting">
    Hello {{ student_name }},
</div>

<div class="content">
    <p>
        Great news! Your project <strong>"{{ project_title }}"</strong> in 
        <strong>{{ classroom_title }}</strong> has been graded by {{ teacher_name }}.
    </p>
</div>

<!-- Grade Display -->
<div class="grade-box {% if is_passing %}passing{% else %}failing{% endif %}">
    <div class="grade-value">{{ grade }}/20</div>
    <div class="grade-label">{{ grade_description }}</div>
</div>

<!-- Grade Progress Bar (visual representation) -->
<div style="margin: 20px 0;">
    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
        <span style="font-size: 13px; color: #6b7280;">Grade Progress</span>
        <span style="font-size: 13px; color: #1f2937; font-weight: 600;">{{ grade_percentage|floatformat:0 }}%</span>
    </div>
    <div style="background-color: #e5e7eb; border-radius: 9999px; height: 10px; overflow: hidden;">
        <div style="background: {% if is_passing %}linear-gradient(90deg, #10b981, #059669){% else %}linear-gradient(90deg, #ef4444, #dc2626){% endif %}; height: 100%; width: {{ grade_percentage }}%; border-radius: 9999px;"></div>
    </div>
</div>

<!-- Project Details -->
<div class="info-box">
    <h3>ğŸ“‹ Project Details</h3>
    
    <div class="info-row">
        <span class="info-label">Project:</span>
        <span class="info-value">{{ project_title }}</span>
    </div>
    
    <div class="info-row">
        <span class="info-label">Classroom:</span>
        <span class="info-value">{{ classroom_title }}</span>
    </div>
    
    <div class="info-row">
        <span class="info-label">Graded By:</span>
        <span class="info-value">{{ teacher_name }}</span>
    </div>
    
    <div class="info-row">
        <span class="info-label">Status:</span>
        <span class="info-value">
            {% if is_passing %}
            <span style="color: #059669; font-weight: 600;">âœ“ Passing</span>
            {% else %}
            <span style="color: #dc2626; font-weight: 600;">âœ— Below Passing</span>
            {% endif %}
        </span>
    </div>
</div>

{% if teacher_notes %}
<!-- Teacher Notes -->
<div class="notes-box">
    <h4>ğŸ“ Teacher's Feedback</h4>
    <p>{{ teacher_notes }}</p>
</div>
{% endif %}

<div class="content">
    <p>
        You can view your complete submission and grade details by clicking the button below.
    </p>
</div>

<!-- Action Buttons -->
<div class="button-container">
    <a href="{{ submission_url }}" class="button">View Submission</a>
    <a href="{{ grades_url }}" class="button button-secondary">View All Grades</a>
</div>

{% if not is_passing %}
<div style="background-color: #fef2f2; border: 1px solid #fecaca; border-radius: 8px; padding: 20px; margin: 20px 0;">
    <p style="color: #991b1b; font-size: 14px; margin: 0;">
        <strong>Note:</strong> Your grade is below the passing threshold (10/20). 
        Please contact your teacher if you have questions about your grade or would like to discuss 
        opportunities for improvement.
    </p>
</div>
{% endif %}

{% if is_passing and grade >= 16 %}
<div style="background-color: #ecfdf5; border: 1px solid #a7f3d0; border-radius: 8px; padding: 20px; margin: 20px 0;">
    <p style="color: #065f46; font-size: 14px; margin: 0;">
        <strong>ğŸ‰ Congratulations!</strong> You achieved an excellent grade. 
        Your hard work and dedication have paid off!
    </p>
</div>
{% endif %}
{% endblock %}
